<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
		<title></title>
		<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, minimal-ui" />
		<style type="text/css" title="Default">
			/* fullscreen */
			html {
				height:100%;
			}
			body {
				height:100%;
				margin: 0px;
				overflow:hidden; /* disable scrollbars */
			}
			/* fix for scroll bars on webkit & >= Mac OS X Lion */ 
			::-webkit-scrollbar {
				background-color: rgba(0,0,0,0.5);
				width: 0.75em;
				height: 0.75em;
			}
			::-webkit-scrollbar-thumb {
    			background-color:  rgba(255,255,255,0.5);
			}

			/* VR mode button */
			#vr-button {
				position: absolute;
				right: 12px;
				bottom: 12px;
				z-index: 9999;
				background: rgba(0,0,0,0.6);
				color: #fff;
				border: none;
				padding: 10px 12px;
				border-radius: 6px;
				font-size: 14px;
				cursor: pointer;
			}
		</style>	
		<link href="styles.css" rel="stylesheet">
	</head>
	<body>
	<!-- -----------8<----------- cut here -----------8<----------- --> 
		<script type="text/javascript" src="pano2vr_player.js">
		</script>
		<div id="container" style="width:100%;height:100%;">
		Loading...
		</div>
		<!-- VR mode button -->
		<button id="vr-button" aria-label="Enter VR mode">VR Mode</button>
		<script type="text/javascript">
			// create the panorama player with the container
			pano=new pano2vrPlayer("container");
			// load the configuration
			window.addEventListener("load", function() {
				pano.readConfigUrlAsync("pano.xml");
			});
		</script>
		<script type="text/javascript">
			(function(){
				const vrButton = document.getElementById('vr-button');
				const container = document.getElementById('container');
				async function enterVR(){
					// Request fullscreen first to maximize compatibility with simple VR viewers
					try{
						if(container.requestFullscreen){
							await container.requestFullscreen();
						}else if(container.webkitRequestFullscreen){
							await container.webkitRequestFullscreen();
						}else if(container.msRequestFullscreen){
							await container.msRequestFullscreen();
						}
					}catch(err){
						console.warn('Fullscreen request failed:', err);
					}
					// Attempt WebXR immersive-vr session when available (best-effort)
					if(navigator.xr && navigator.xr.isSessionSupported){
						try{
							const supported = await navigator.xr.isSessionSupported('immersive-vr');
							if(supported){
								try{
									const session = await navigator.xr.requestSession('immersive-vr');
									console.log('WebXR session started', session);
									// Note: starting a full WebXR presentation typically requires an XR-compatible renderer.
									// We keep the session open so VR-capable browsers/devices can present the page.
									session.addEventListener('end', ()=>{ console.log('XR session ended'); });
									return;
								}catch(e){
									console.warn('Failed to start XR session:', e);
								}
							}
						}catch(e){
							console.warn('Error checking XR support:', e);
						}
					}
					// If we reach here, either WebXR wasn't available or failed â€” user is in fullscreen now.
					try{
						if(!document.fullscreenElement){
							alert('Entered fullscreen. If your VR device supports WebXR, open the page in a VR-capable browser to enter immersive VR.');
						}
					}catch(e){}
				}
				vrButton.addEventListener('click', enterVR);
			})();
		</script>
		<noscript>
			<p><b>Please enable Javascript!</b></p>
		</noscript>
	<!-- -----------8<----------- cut here -----------8<----------- --> 
	</body>
</html>
